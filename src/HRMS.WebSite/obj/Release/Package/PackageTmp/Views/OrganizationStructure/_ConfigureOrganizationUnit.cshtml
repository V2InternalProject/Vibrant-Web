@model HRMS.Models.OrganizationStructure
@{
    ViewBag.Title = "Index";
}
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("../../Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
@section HeaderLinks{
    @Html.Partial("_HeaderLinks", Model.SearchedUserDetails)
}
<br />
<h2 class="title-bgcolor">
    Configure Organization Unit</h2>
<div class="stackhold-right">
    <input class="button" type="button" value="Save" id="SaveDetails" />
     <input class="button" type="button" id="AddExistingDU" value="Add Existing DU" />
</div>
<h3 class="Configure-title">
    Organization Unit</h3>
@using (Html.BeginForm("", "", FormMethod.Post, new { id = "ConfigOrganizationUnit" }))
{
    @Html.ValidationSummary(true)
    @Html.HiddenFor(x => x.LocationID)
    <div style="float: inherit">
        <div class="organization-popup">
            <div class="organization-lab">@Html.Label("Organization Unit")<span class="mandatory">*</span></div>
            <div class="organization-inp1">@Html.TextBoxFor(x => x.Location)
                <p>@Html.ValidationMessageFor(x => x.Location)</p>
            </div>
        </div>
        <div class="organization-popup" style="clear: both">
            <div class="organization-lab">@Html.LabelFor(x => x.Active)</div>
            <div class="organization-checkbox">@Html.CheckBoxFor(x => x.Active)</div>
        </div>
        <div class="organization-popup organization-bor">
            <div class="organization-left-popup">
                <div class="organization-lab">@Html.Label("Organization Unit Code : ")</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.LocationCode, new { @disabled = "disabled" })</div>
                <div class="organization-lab">@Html.LabelFor(x => x.Address)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Address)</div>
                <div class="organization-lab">@Html.LabelFor(x => x.City)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.City)</div>
                <div class="organization-lab">@Html.LabelFor(x => x.State)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.State)</div>
                <div class="organization-lab">@Html.LabelFor(x => x.Phone1)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Phone1)<p>@Html.ValidationMessageFor(x => x.Phone1)</p>
                </div>
                <div class="organization-lab">@Html.LabelFor(x => x.Fax)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Fax)<p>@Html.ValidationMessageFor(x => x.Fax)</p>
                </div>
                <div class="organization-lab">@Html.LabelFor(x => x.WorkingHours)<span class="mandatory">*</span></div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.WorkingHours)<p>@Html.ValidationMessageFor(x => x.WorkingHours)</p>
                </div>
            </div>
            <div class="organization-right-popup">
                <div class="organization-lab">@Html.LabelFor(x => x.ShortCode)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.ShortCode)</div>
                <div class="organization-lab">@Html.LabelFor(x => x.Address1)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Address1)</div>
                <div class="organization-lab">@Html.LabelFor(x => x.Zip)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Zip)<p>@Html.ValidationMessageFor(x => x.Zip)</p>
                </div>
                <div class="organization-lab">@Html.LabelFor(x => x.Country)</div>
                <div class="organization-inp">@Html.DropDownListFor(x => x.Country, new SelectList(Model.CountryList, "CountryId", "CountryName"), "Select")</div>
                <div class="organization-lab">@Html.LabelFor(x => x.Phone2)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Phone2)<p>@Html.ValidationMessageFor(x => x.Phone2)</p>
                </div>
                <div class="organization-lab">@Html.LabelFor(x => x.Email)</div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.Email)<p>@Html.ValidationMessageFor(x => x.Email)</p>
                </div>
                <div class="organization-lab">@Html.LabelFor(x => x.WorkingDays)<span class="mandatory">*</span></div>
                <div class="organization-inp">@Html.TextBoxFor(x => x.WorkingDays)<p>@Html.ValidationMessageFor(x => x.WorkingDays)</p>
                </div>
            </div>
        </div>
    </div>
}
<h3 class="Configure-title">
    Details</h3>
<table class="sub-link" align="center">
    <tr>
        <td>
            <a href="#" onclick="DocumentCategories()">Document Categories</a><span> | </span>
        </td>
        <td>
            <a href="#" onclick="DeliveryUnits()">Delivery Units</a><span> | </span>
        </td>
        <td>
            <a href="#" onclick="OUManagers()">OU Managers</a> <span>| </span>
        </td>
        <td>
            <a href="#" onclick="MiddleLevelResource()">Middle Level Resources</a>
        </td>
    </tr>
</table>
<div id="documentcategoriesdiv">
    <div class="stackhold-right">
        <input type="button" class="button" id="AddDocumentCategories" value="Add" />
        <input type="button" class="button" id="DeleteDocumentCategories" value="Delete" />
        <input type="button" class="button" id="SelectAllDocumentCategories" value="Select All"
            onclick="SelectOrganizationUnits()" />
        <input type="button" class="button" id="DeselectAllDocumentCategories" value="Deselect All"
            onclick="DeselectOrganizationUnits()" />
    </div>
    <h3 class="Configure-title">
        Document Categories</h3>
    <table cellpadding="0" cellspacing="0" width="100%" border="0" id="tbl_DocumentCategories">
        <thead>
            <tr class="bluebgtable1">
                <td width="10%">
                    Category
                </td>
                <td class="bluebgtable1" width="15%">
                    Delete
                </td>
            </tr>
        </thead>
        <div id="DocumentCategories" class="docListDiv">
            @foreach (var item in Model.OrganizationUnitDocumentCategory)
            {
                <tr>
                    <td>
                        <a href="#" id="@item.CategoryID" class="@item.LocationID" onclick="AddDocumentCategory(this)">@item.Category</a><br />
                    </td>
                    <td align="center">
                        @Html.CheckBoxFor(modelItem => item.Checked, new { @id = item.CategoryID, @class = "OrgDocuments" })
                    </td>
                </tr>
            }
        </div>
    </table>
    <br />
    <table align="right">
        <thead class="bluebutton1">
            <tr>
                <td class="bluebgtable1">
                    @Html.LabelFor(x => x.TotalDocumentCategories)
                    @Html.DisplayFor(x => x.TotalDocumentCategories)
                </td>
            </tr>
        </thead>
    </table>
    <br />
</div>
<div id="deliveryunitdiv">
    <br />
    <div class="stackhold-right">
        <input type="button" class="button" id="AddOUDeliveryUnitbtn" value="Add" />
        <input type="button" class="button" id="DeleteOUDeliveryUnit" value="Delete" />
        <input type="button" class="button" id="SelectAllOUDeliveryUnit" value="Select All" />
        <input type="button" class="button" id="DeselectAllOUDeliveryUnit" value="Deselect All" />
    </div>
    <h3 class="Configure-title">
        Delivery Units</h3>
    <table cellpadding="0" cellspacing="0" border="0" id="tbl_DeliveryUnits" style="width:100%">
        <thead>
            <tr class="bluebgtable1">
                <td width="10%">
                    Delivery Unit
                </td>
                <td class="bluebgtable1" width="15%">
                    Delivery Unit Code
                </td>
                <td class="bluebgtable1" width="15%">
                    Delete
                </td>
            </tr>
        </thead>
        <div id="DeliveryUnits">
            @foreach (var item in Model.DeliveryUnits)
            {
                <tr>
                    <td id="DeliveryUnit">
                        @*<a href="#" id="@item.ResourcePoolID" class="@item.LocationID" onclick="AddDeliveryUnit(this)">@item.ResourcePoolName</a><br />*@
                        @Html.DisplayFor(modelItem => item.ResourcePoolName, new { @readonly = "readonly" })
                    </td>
                    <td id="DeliveryUnitCode">
                        @Html.DisplayFor(modelItem => item.ResourcePoolCode, new { @readonly = "readonly" })
                    </td>
                    <td align="center">
                        @Html.CheckBoxFor(modelItem => item.Checked, new { @id = item.ResourcePoolID, @class = "CBOUDeliveryUnit", @for = item.LocationID })
                    </td>
                </tr>
            }
        </div>
    </table>
    <br />
    <table align="right">
        <thead class="bluebgtable1">
            <tr>
                <td>
                    @Html.LabelFor(x => x.TotalDeliveryUnits)
                    @Html.DisplayFor(x => x.TotalDeliveryUnits)
                </td>
            </tr>
        </thead>
    </table>
</div>
<div id="oumanagersdiv">
    <div class="stackhold-right">
        <input type="button" class="button" id="AddOUManagerbtn" value="Add" />
        <input type="button" class="button" id="DeleteOUManagerbtn" value="Delete" />
        <input type="button" class="button" id="SelectAllOUManager" value="Select All" />
        <input type="button" class="button" id="DeselectAllOUManager" value="Deselect All" />
    </div>
    <h3 class="Configure-title">
        OU Managers</h3>
    <table cellpadding="0" cellspacing="0" width="100%" border="0" id="tbl_OUManagers">
        <thead>
            <tr class="bluebgtable1">
                <td width="10%">
                    Manager
                </td>
                <td class="bluebgtable1" width="15%">
                    Is Primary Responsible
                </td>
                <td class="bluebgtable1" width="15%">
                    Delete
                </td>
            </tr>
        </thead>
        <div id="OuManagers">
            @foreach (var item in Model.OUManagerList)
            {
                <tr>
                    <td id="EmployeeName">
                        <a href="#" id="@item.EmployeeID" class="@item.LocationID" onclick="AddOUManager(this)">@item.UserName</a><br />
                    </td>
                    <td id="IsPrimaryresponsible">
                        @Html.Label(item.IsPrimaryResponsible ? "Yes" : "No")
                    </td>
                    <td align="center">
                        @Html.CheckBoxFor(modelItem => item.Checked, new { @id = item.EmployeeID, @class = "OuManagers" })
                    </td>
                </tr>
            }
        </div>
    </table>
    <br />
    <table align="right">
        <thead class="bluebgtable1">
            <tr>
                <td>
                    @Html.LabelFor(x => x.TotalOUManagers)
                    @Html.DisplayFor(x => x.TotalOUManagers)
                </td>
            </tr>
        </thead>
    </table>
</div>
<br />
<div id="middlelevelresourcediv">
    <br />
    <div class="stackhold-right">
        <input type="button" class="button" id="SelectResource" value="Selectresource" />
        <input type="button" class="button" id="DeleteResource" value="Delete" />
        <input type="button" class="button" id="SelectAllResource" value="Select All" />
        <input type="button" class="button" id="DeselectAllResource" value="Deselect All" />
    </div>
    <h3 class="Configure-title">
        Middle Level Resources
    </h3>
    <table cellpadding="0" cellspacing="0" width="100%" border="0" id="tbl_middlelevelresource">
        <thead>
            <tr class="bluebgtable1">
                <td width="10%">
                    Employee Name
                </td>
                <td class="bluebgtable1" width="15%">
                    Role
                </td>
                <td class="bluebgtable1" width="15%">
                    Email ID
                </td>
                <td class="bluebgtable1" width="15%">
                    Delete
                </td>
            </tr>
        </thead>
        <div id="MiddleLevelResourcesList">
            @foreach (var item in Model.MiddleLevelResourcesList)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.EmployeeName, new { @readonly = "readonly" })
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Role, new { @readonly = "readonly" })
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.EmailID, new { @readonly = "readonly" })
                    </td>
                    <td align="center">
                        @Html.CheckBoxFor(modelItem => item.Checked, new { @class = "selectAllMiddleLevelResources", @id = item.EmpoloyeeID, @for = item.LocationID })
                    </td>
                </tr>
            }
        </div>
    </table>
    <br />
    <table align="right">
        <thead class="bluebgtable1">
            <tr>
                <td>
                    @Html.LabelFor(x => x.TotalMiddleLevelResources)
                    @Html.DisplayFor(x => x.TotalMiddleLevelResources)
                </td>
            </tr>
        </thead>
    </table>
    <br />
</div>
<div id="AddDocumentCategoryDialog">
</div>
<div id="addOuManagerDialog">
</div>
<div id="SelectResourcefromListDialog">
</div>
<div id="AddOUDeliveyUnitDialog">
</div>
<div id="ErrorInPage" style="display: none" title="Error">
    <center class="LoadingWrap">
          There is some error.
    </center>
</div>
<div id="ErrorInSave" style="display: none" title="Error">
    <center class="LoadingWrap">
          Error in Save.
    </center>
</div>
<div id="NoItemSelectedDocuments" style="display: none" title="Record Delete">
    <center class="LoadingWrap">
          Please select atleast one record to delete.
    </center>
</div>
<div id="DeleteDocumentCategoryConfirm" style="display: none" title="Record Delete">
    <center class="LoadingWrap">
          Are you sure, you want to delete selected record ?
    </center>
</div>
<div id="DeleteDocumentCategorySuccess" style="display: none" title="Record Deleted">
    <center class="LoadingWrap">
          The selected record is successfully deleted.
    </center>
</div>
<div id="ErrorDocument" style="display: none" title="Error">
    <center class="LoadingWrap">
          There is some error.
    </center>
</div>
<div id="ErrorSaveOU" style="display: none" title="Record Deleted">
    <center class="LoadingWrap">
          This Organization Unit can't be inactive as having child underneath of it.
    </center>
</div>
<div id="ErrorSaveOUDU" style="display: none" title="Record Deleted">
    <center class="LoadingWrap">
          This Delivery Unit can't be inactive as having child underneath of it.
    </center>
</div>
<div id="addexistingdeliveryUnit" style="display: none">
</div>
<script type="text/javascript">
    $.ajaxSetup({
        // Disable caching of AJAX responses
        cache: false
    });
    $.validator.unobtrusive.parse($("#ConfigOrganizationUnit"));
    $("#SaveDetails").click(function () {

        if ($("#ConfigOrganizationUnit").valid()) {
            $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
            $("#LocationCode").removeAttr("disabled");
            $("#LocationID").val('@Model.LocationID')
            $.ajax({
                url: '@Url.Action("SaveConfigureOrganizationUnit", "OrganizationStructure")',
                type: 'Post',
                data: $("#ConfigOrganizationUnit").serialize(),
                success: function (results) {
                    $("#loading").dialog("close");
                    $("#loading").dialog("destroy");
                    $("#LocationCode").attr("disabled", "disabled");
                    if (results.resultMesssage == "Error") {
                        $("#ErrorSaveOU").dialog({
                            closeOnEscape: false,
                            resizable: false,
                            height: 'auto',
                            width: 300,
                            modal: true,
                            dialogClass: 'noclose',
                            buttons: {
                                Ok: function () {
                                    $(this).dialog("close");
                                    $("#ConfigureOrganizationUnitDialog").dialog('close');
                                    $("#ConfigureOrganizationUnitDialog").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 650,
                                        width: 1100,
                                        modal: true,
                                        title: "Configure Organization Unit",
                                        open: function (event, ui) {
                                            $('#ConfigureOrganizationUnitDialog').load("/OrganizationStructure/ConfigureOrganizationUnit", { locationId: '@Model.LocationID' }).dialog('open');
                                        }
                                    });
                                }
                            }
                        });
                    }
                    if (results.resultMesssage == "ErrorInSave") {
                        $("#ErrorInSave").dialog({
                            closeOnEscape: false,
                            resizable: false,
                            height: 'auto',
                            width: 300,
                            modal: true,
                            dialogClass: 'noclose',
                            buttons: {
                                Ok: function () {
                                    $(this).dialog("close");
                                    $("#ConfigureOrganizationUnitDialog").dialog('close');
                                    $("#ConfigureOrganizationUnitDialog").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 650,
                                        width: 1100,
                                        modal: true,
                                        title: "Configure Organization Unit",
                                        open: function (event, ui) {
                                            $('#ConfigureOrganizationUnitDialog').load("/OrganizationStructure/ConfigureOrganizationUnit", { locationId: '@Model.LocationID' }).dialog('open');
                                        }
                                    });
                                }
                            }
                        });
                    }
                    if (results.status == true) {

                        $("#ConfigureOrganizationUnitDialog").dialog("close");
                        $("#ConfigureOrganizationUnitDialog").dialog("destroy");
                        location.reload();
                    }
                },
                error: function () {
                    $("#loading").dialog("close");
                    $("#loading").dialog("destroy");
                    $("#LocationCode").attr("disabled", "disabled");
                    $("#ErrorInPage").dialog({
                        closeOnEscape: false,
                        resizable: false,
                        height: 'auto',
                        width: 300,
                        modal: true,
                        dialogClass: 'noclose',
                        buttons: {
                            Ok: function () {
                                $(this).dialog("close");
                            }
                        }
                    });
                }
            });
        }
    });

    $(document).ready(function () {
        $("#documentcategoriesdiv").show();
        $("#deliveryunitdiv").hide();
        $("#oumanagersdiv").hide();
        $("#middlelevelresourcediv").hide();
    });

    function DocumentCategories() {
        $("#documentcategoriesdiv").show();
        $("#deliveryunitdiv").hide();
        $("#oumanagersdiv").hide();
        $("#middlelevelresourcediv").hide();
    }

    function DeliveryUnits() {
        $("#deliveryunitdiv").show();
        $("#documentcategoriesdiv").hide();
        $("#oumanagersdiv").hide();
        $("#middlelevelresourcediv").hide();
    }

    function OUManagers() {
        $("#oumanagersdiv").show();
        $("#deliveryunitdiv").hide();
        $("#documentcategoriesdiv").hide();
        $("#middlelevelresourcediv").hide();
    }
    function MiddleLevelResource() {
        $("#middlelevelresourcediv").show();
        $("#documentcategoriesdiv").hide();
        $("#deliveryunitdiv").hide();
        $("#oumanagersdiv").hide();
    }

    function SelectOrganizationUnits() {
        $(".OrgDocuments").attr("checked", true);
    }
    function DeselectOrganizationUnits() {

        $(".OrgDocuments").attr("checked", false);
    }
    $("#SelectAllOUManager").click(function () {
        $(".OuManagers").attr("checked", true);
    });
    $("#DeselectAllOUManager").click(function () {
        $(".OuManagers").attr("checked", false);
    });
    $("#SelectAllResource").click(function () {
        $(".selectAllMiddleLevelResources").attr("checked", true);
    });

    $("#DeselectAllResource").click(function () {
        $(".selectAllMiddleLevelResources").attr("checked", false);
    });

    $("#SelectAllOUDeliveryUnit").click(function () {
        $(".CBOUDeliveryUnit").attr("checked", true);
    });
    $("#DeselectAllOUDeliveryUnit").click(function () {
        $(".CBOUDeliveryUnit").attr("checked", false);
    });

    function AddDocumentCategory(id) {

        var categoryId = id.id;
        var locationId = id.className;
        var addedCategoryID = "";
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        $.each($(".OrgDocuments"), function (i, val) {

            addedCategoryID = addedCategoryID + $(val).attr("id") + ',';
        });
        $.ajax({
            url: '@Url.Action("AddOrganizationUnitDocumentCategory", "OrganizationStructure")',
            type: 'GET',
            data: { categoryId: categoryId,
                locationId: locationId,
                addedCategoryId: addedCategoryID
            },
            async: true,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#AddDocumentCategoryDialog").empty().append(results);
                $("#AddDocumentCategoryDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 500,
                    title: "Document Categories",
                    close: function (event, ui) {
                        $("#AddDocumentCategoryDialog").empty();
                        $("#AddDocumentCategoryDialog").dialog("destroy");
                        $(".field-validation-error").empty();
                        $('input').removeClass("input-validation-error");
                    }
                });
            }
        });
    }

    $("#AddDocumentCategories").click(function () {

        var addedCategoryID = "";
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        $.each($(".OrgDocuments"), function (i, val) {

            addedCategoryID = addedCategoryID + $(val).attr("id") + ',';
        });
        $.ajax({
            url: '@Url.Action("AddOrganizationUnitDocumentCategory", "OrganizationStructure")',
            type: 'GET',
            data: { categoryId: 0,
                locationId: '@Model.LocationID',
                addedCategoryId: addedCategoryID
            },
            async: true,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#AddDocumentCategoryDialog").empty().append(results);
                $("#AddDocumentCategoryDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 500,
                    title: "Document Categories",
                    close: function (event, ui) {
                        $("#AddDocumentCategoryDialog").empty();
                        $("#AddDocumentCategoryDialog").dialog("destroy");
                        $(".field-validation-error").empty();
                        $('input').removeClass("input-validation-error");
                    }
                });
            }
        });
    });

    $("#DeleteDocumentCategories").click(function () {

        var categoryId = "";
        $.each($('input[class=OrgDocuments]:checked'), function (i, val) {
            categoryId = categoryId + $(val).attr("id") + (',');
        });
        var locationId = '@Model.LocationID';
        if (categoryId == "") {
            $("#NoItemSelectedDocuments").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    OK: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
        else {
            $("#DeleteDocumentCategoryConfirm").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    Ok: function () {
                        $("#loading").dialog(
                           {
                               closeOnEscape: false,
                               resizable: false,
                               height: 140,
                               width: 300,
                               modal: true,
                               dialogClass: "noclose"
                           });
                        $.ajax({
                            url: '@Url.Action("DeleteDocumentCategory", "OrganizationStructure")',
                            data: JSON.stringify({ categoryId: categoryId,
                                locationId: locationId
                            }),
                            type: 'post',
                            datatype: "json",
                            contentType: 'application/json; charset=utf-8',
                            success: function (results) {
                                $("#loading").dialog("close");
                                $("#loading").dialog("destroy");
                                if (results.status == true) {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close").remove();
                                    $("#DeleteDocumentCategorySuccess").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                                $(".OrgDocuments").prop("checked", false);
                                                $("#ConfigureOrganizationUnitDialog").dialog("close");
                                                $("#ConfigureOrganizationUnitDialog").dialog("destroy");
                                                $("#ConfigureOrganizationUnitDialog").dialog({
                                                    closeOnEscape: false,
                                                    resizable: false,
                                                    height: 650,
                                                    width: 1100,
                                                    modal: true,
                                                    title: "Configure Business Group",
                                                    open: function (event, ui) {
                                                        $('#ConfigureOrganizationUnitDialog').load("/OrganizationStructure/ConfigureOrganizationUnit", { locationId: '@Model.LocationID' }).dialog('open');
                                                    }
                                                });
                                            }
                                        }
                                    });
                                }
                                else {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close");
                                    $("#ErrorDocument").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                            }
                                        }
                                    });
                                }
                            }
                        }); // ajax End
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
    });

    function AddDeliveryUnit(id) {

        var locationId = id.className;
        var resourcePoolId = id.id;
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        $.ajax({
            url: '@Url.Action("AddOUDeliveryUnit", "OrganizationStructure")',
            type: 'GET',
            data: { resourcePoolId: resourcePoolId,
                locationId: locationId
            },
            async: true,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#AddOUDeliveyUnitDialog").empty().append(results);
                $("#AddOUDeliveyUnitDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 500,
                    title: "Delivery Unit",
                    close: function (event, ui) {
                        $(".field-validation-error").empty();
                        $('input').removeClass("input-validation-error");
                        $("#AddOUDeliveyUnitDialog").empty();
                        $("#AddOUDeliveyUnitDialog").dialog("destroy");
                    }
                });
            }
        });
    };

    $("#AddOUDeliveryUnitbtn").click(function () {
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        $.ajax({
            url: '@Url.Action("AddOUDeliveryUnit", "OrganizationStructure")',
            type: 'GET',
            data: { resourcePoolId: 0,
                locationId: '@Model.LocationID'
            },
            async: true,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#AddOUDeliveyUnitDialog").empty().append(results);
                $("#AddOUDeliveyUnitDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 500,
                    title: "Delivery Unit",
                    close: function (event, ui) {
                        $(".field-validation-error").empty();
                        $('input').removeClass("input-validation-error");
                        $("#AddOUDeliveyUnitDialog").empty();
                        $("#AddOUDeliveyUnitDialog").dialog("destroy");
                    }
                });
            }
        });
    });

    $("#DeleteOUDeliveryUnit").click(function () {

        var collection = [];
        $.each($("input.CBOUDeliveryUnit:checked"), function (i, val) {
            if ($(val).attr("id") != undefined) {
                collection.push($(val).attr("id"));
            }
        });

        if (collection.length == 0) {
            $("#NoItemSelectedDocuments").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    OK: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
        else {
            $("#DeleteDocumentCategoryConfirm").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    Ok: function () {
                        $("#loading").dialog(
                           {
                               closeOnEscape: false,
                               resizable: false,
                               height: 140,
                               width: 300,
                               modal: true,
                               dialogClass: "noclose"
                           });
                        $.ajax({
                            url: '@Url.Action("DeleteOUDeliveryUnit", "OrganizationStructure")',
                            data: JSON.stringify({ collection: collection }),
                            type: 'post',
                            datatype: "json",
                            contentType: 'application/json; charset=utf-8',
                            success: function (results) {
                                $("#loading").dialog("close");
                                $("#loading").dialog("destroy");
                                if (results.status == true) {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close").remove();
                                    $("#DeleteDocumentCategorySuccess").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                                $(".CBOUDeliveryUnit").prop("checked", false);
                                                $("#ConfigureOrganizationUnitDialog").dialog("close");
                                                $("#ConfigureOrganizationUnitDialog").dialog("destroy");
                                                $("#ConfigureOrganizationUnitDialog").dialog({
                                                    closeOnEscape: false,
                                                    resizable: false,
                                                    height: 650,
                                                    width: 1100,
                                                    modal: true,
                                                    title: "Configure Business Group",
                                                    open: function (event, ui) {
                                                        $('#ConfigureOrganizationUnitDialog').load("/OrganizationStructure/ConfigureOrganizationUnit", { locationId: '@Model.LocationID' }).dialog('open');
                                                    }
                                                });
                                            }
                                        }
                                    });
                                }
                                else {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close");
                                    $("#ErrorSaveOUDU").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                            }
                                        }
                                    });
                                }
                            }
                        }); // ajax End
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
    });

    function AddOUManager(id) {
        var employeeId = id.id;
        var locationId = id.className;
        var addedEmployeeID = "";
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        $.each($(".OuManagers"), function (i, val) {

            addedEmployeeID = addedEmployeeID + $(val).attr("id") + ',';
        });
        $.ajax({
            url: '@Url.Action("AddOrganizationUnitManager", "OrganizationStructure")',
            type: 'GET',
            data: { employeeId: employeeId,
                locationId: locationId,
                addedEmployeeID: addedEmployeeID
            },
            async: true,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#addOuManagerDialog").empty().append(results);
                $("#addOuManagerDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 500,
                    title: "OU Managers",
                    close: function (event, ui) {
                        $(".field-validation-error").empty();
                        $('input').removeClass("input-validation-error");
                        $("#addOuManagerDialog").empty();
                        $("#addOuManagerDialog").dialog("destroy");
                    }
                });
            }
        });
    }

    $("#AddOUManagerbtn").click(function () {

        var addedEmployeeID = "";
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        $.each($(".OuManagers"), function (i, val) {

            addedEmployeeID = addedEmployeeID + $(val).attr("id") + ',';
        });
        $.ajax({
            url: '@Url.Action("AddOrganizationUnitManager", "OrganizationStructure")',
            type: 'GET',
            data: { employeeId: 0,
                locationId: '@Model.LocationID',
                addedEmployeeID: addedEmployeeID
            },
            async: true,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#addOuManagerDialog").empty().append(results);
                $("#addOuManagerDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 500,
                    title: "OU Managers",
                    close: function (event, ui) {
                        $(".field-validation-error").empty();
                        $('input').removeClass("input-validation-error");
                        $("#addOuManagerDialog").empty();
                        $("#addOuManagerDialog").dialog("destroy");
                    }
                });
            }
        });
    });

    $("#DeleteOUManagerbtn").click(function () {

        var employeeId = "";
        $.each($('input[class=OuManagers]:checked'), function (i, val) {
            employeeId = employeeId + $(val).attr("id") + (',');
        });
        var locationId = '@Model.LocationID';
        if (employeeId == "") {
            $("#NoItemSelectedDocuments").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    OK: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
        else {
            $("#DeleteDocumentCategoryConfirm").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    Ok: function () {
                        $("#loading").dialog(
                         {
                             closeOnEscape: false,
                             resizable: false,
                             height: 140,
                             width: 300,
                             modal: true,
                             dialogClass: "noclose"
                         });
                        $.ajax({
                            url: '@Url.Action("DeleteOUManagers", "OrganizationStructure")',
                            data: JSON.stringify({ employeeId: employeeId,
                                locationId: locationId
                            }),
                            type: 'post',
                            datatype: "json",
                            contentType: 'application/json; charset=utf-8',
                            success: function (results) {
                                $("#loading").dialog("close");
                                $("#loading").dialog("destroy");
                                if (results.status == true) {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close").remove();
                                    $("#DeleteDocumentCategorySuccess").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                                $(".employeeId").prop("checked", false);
                                                $("#ConfigureOrganizationUnitDialog").dialog("close");
                                                $("#ConfigureOrganizationUnitDialog").dialog("destroy");
                                                $("#ConfigureOrganizationUnitDialog").dialog({
                                                    closeOnEscape: false,
                                                    resizable: false,
                                                    height: 650,
                                                    width: 1100,
                                                    modal: true,
                                                    title: "Configure Business Group",
                                                    open: function (event, ui) {
                                                        $('#ConfigureOrganizationUnitDialog').load("/OrganizationStructure/ConfigureOrganizationUnit", { locationId: '@Model.LocationID' }).dialog('open');
                                                    }
                                                });
                                            }
                                        }
                                    });
                                }
                                else {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close");
                                    $("#ErrorDocument").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                            }
                                        }
                                    });
                                }
                            }
                        }); // ajax End
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
    });

    $("#SelectResource").click(function () {
        $("#loading").dialog(
              {
                  closeOnEscape: false,
                  resizable: false,
                  height: 140,
                  width: 300,
                  modal: true,
                  dialogClass: "noclose"
              });
        var EmployeeID = "";
        $.each($(".selectAllMiddleLevelResources"), function (i, val) {
            EmployeeID = EmployeeID + $(val).attr("id") + (',');
        });

        $.ajax({
            url: '@Url.Action("SelectOUResouces", "OrganizationStructure")',
            type: 'GET',
            data: { EmployeeID: EmployeeID,
                LocationID: '@Model.LocationID'
            },
            async: false,
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#SelectResourcefromListDialog").empty().append(results);
                $("#SelectResourcefromListDialog").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 600,
                    width: 900,
                    title: "Select Resources for Organization Unit",
                    close: function (event, ui) {
                        $("#SelectResourcefromListDialog").empty();
                        $("#SelectResourcefromListDialog").dialog("destroy");
                    }
                });
            }
        });
    });

    $("#DeleteResource").click(function () {

        var collection = [];
        $.each($("input.selectAllMiddleLevelResources:checked"), function (i, val) {
            if ($(val).attr("id") != undefined) {
                collection.push($(val).attr("id"));
            }
        });
        var LocationID = $(".selectAllMiddleLevelResources").attr("for");
        if (collection.length == 0) {
            $("#NoItemSelectedDocuments").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    OK: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
        else {
            $("#DeleteDocumentCategoryConfirm").dialog({
                closeOnEscape: false,
                resizable: false,
                height: 'auto',
                width: 300,
                modal: true,
                dialogClass: 'noclose',
                buttons: {
                    Ok: function () {
                        $("#loading").dialog(
                          {
                              closeOnEscape: false,
                              resizable: false,
                              height: 140,
                              width: 300,
                              modal: true,
                              dialogClass: "noclose"
                          });
                        $.ajax({
                            url: '@Url.Action("DeleteOUMiddleLevelResources", "OrganizationStructure")',
                            data: JSON.stringify({ collection: collection,
                                LocationID: LocationID
                            }),
                            type: 'post',
                            datatype: "json",
                            contentType: 'application/json; charset=utf-8',
                            success: function (results) {
                                $("#loading").dialog("close");
                                $("#loading").dialog("destroy");
                                if (results.status == true) {
                                    $("#DeleteDocumentCategoryConfirm").dialog("destroy").remove()
                                    $("#DeleteDocumentCategorySuccess").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                                $(".selectAllMiddleLevelResources").prop("checked", false);
                                                $("#ConfigureOrganizationUnitDialog").dialog("close");
                                                $("#ConfigureOrganizationUnitDialog").dialog("destroy");
                                                $("#ConfigureOrganizationUnitDialog").dialog({
                                                    closeOnEscape: false,
                                                    resizable: false,
                                                    height: 650,
                                                    width: 1100,
                                                    modal: true,
                                                    title: "Configure Business Group",
                                                    open: function (event, ui) {
                                                        $('#ConfigureOrganizationUnitDialog').load("/OrganizationStructure/ConfigureOrganizationUnit", { locationId: '@Model.LocationID' }).dialog('open');
                                                    }
                                                });
                                            }
                                        }
                                    });
                                }
                                else {
                                    $("#DeleteDocumentCategoryConfirm").dialog("close");
                                    $("#ErrorDocument").dialog({
                                        closeOnEscape: false,
                                        resizable: false,
                                        height: 'auto',
                                        width: 300,
                                        modal: true,
                                        dialogClass: 'noclose',
                                        buttons: {
                                            Ok: function () {
                                                $(this).dialog("close");
                                            }
                                        }
                                    });
                                }
                            }
                        }); // ajax End
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });
        }
    });

    //added by Nikhil
    $("#AddExistingDU").click(function () {
        $("#loading").dialog(
        {
            closeOnEscape: false,
            resizable: false,
            height: 140,
            width: 300,
            modal: true,
            dialogClass: "noclose"
        });
        $(".field-validation-error").empty();
        $('input').removeClass("input-validation-error");
        $.ajax({
            url: '@Url.Action("LoadExistingDU", "OrganizationStructure")',
            data: { LocationID: '@Model.LocationID' },
            type: 'GET',
            success: function (results) {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                if (results != null) {
                    $('#addexistingdeliveryUnit').html(results);
                    $("#addexistingdeliveryUnit").dialog({
                        closeOnEscape: false,
                        resizable: false,
                        height: 'auto',
                        width: 450,
                        title: "Add Existing DU",
                        close: function (event, ui) {
                            $(this).dialog("destroy");
                        }
                    });
                }
                else {
                    $("#ErrorManager").dialog({
                        closeOnEscape: false,
                        resizable: false,
                        height: 'auto',
                        width: 300,
                        modal: true,
                        dialogClass: 'noclose',
                        buttons: {
                            Ok: function () {
                                $(this).dialog('close');
                                $(this).dialog('destroy');
                            }
                        }
                    });
                }
            },
            Error: function () {
                $("#loading").dialog("close");
                $("#loading").dialog("destroy");
                $("#ErrorManager").dialog({
                    closeOnEscape: false,
                    resizable: false,
                    height: 'auto',
                    width: 300,
                    modal: true,
                    dialogClass: 'noclose',
                    buttons: {
                        Ok: function () {
                            $(this).dialog('close');
                            $(this).dialog('destroy');
                        }
                    }
                });
            }
        });
    });
</script>